(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["course-video"],{"1be4":function(e,t,r){var n=r("d066");e.exports=n("document","documentElement")},"1f26":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("el-card",[r("el-form",{attrs:{"label-width":"80px"}},[r("el-form-item",{attrs:{label:"课程名称"}},[r("el-input",{attrs:{disabled:""},model:{value:e.course.courseName,callback:function(t){e.$set(e.course,"courseName",t)},expression:"course.courseName"}})],1),r("el-form-item",{attrs:{label:"课时名称"}},[r("el-input",{attrs:{disabled:""},model:{value:e.theme,callback:function(t){e.theme=t},expression:"theme"}})],1),r("el-form-item",{attrs:{label:"视频上传"}},[r("input",{ref:"video-file",attrs:{type:"file"}})]),r("el-form-item",{attrs:{label:"封面上传"}},[r("input",{ref:"image-file",attrs:{type:"file"}})]),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.authUpload}},[e._v("开始上传")]),r("el-button",[e._v("返回")])],1)],1),e.start?r("div",[r("p",[e._v("视频名称："+e._s(e.fileName))]),r("p",[e._v("阿里云上传进度：100%; 阿里云上传结果：上传成功;")]),e.trans?r("p",[e._v("阿里云转码状态：请勿刷新页面，正在转码，请稍后..;")]):e._e()]):e._e()],1)],1)},o=[],a=(r("b0c0"),r("a9e3"),r("96cf"),r("1da1")),u=(r("bc3a"),r("b32d")),i=function(){return Object(u["a"])({method:"GET",url:"/boss/course/upload/aliyunImagUploadAddressAdnAuth.json"})},s=function(e){return Object(u["a"])({method:"GET",url:"/boss/course/upload/aliyunVideoUploadAddressAdnAuth.json",params:e})},c=function(e){return Object(u["a"])({method:"POST",url:"/boss/course/upload/aliyunTransCode.json",data:e})},l=function(e){return Object(u["a"])({method:"GET",url:"/boss/course/upload/aliyunTransCodePercent.json",params:{lessonId:e}})},d=r("6fd8"),f={data:function(){return{uploader:null,videoId:null,imageUrl:"",fileName:"",course:{}}},props:{courseId:{type:[String,Number],required:!0},theme:{type:[String]}},created:function(){this.loadCourse(),this.initUploader()},methods:{loadCourse:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["b"])(e.courseId);case 2:r=t.sent,n=r.data,e.course=n.data,console.log(n,e.theme);case 6:case"end":return t.stop()}}),t)})))()},authUpload:function(){this.start=!0;var e=this.$refs["video-file"].files[0];this.uploader.addFile(e,null,null,null,'{"Vod":{}}'),this.uploader.addFile(this.$refs["image-file"].files[0],null,null,null,'{"Vod":{}}'),this.fileName=e.name,this.uploader.startUpload()},initUploader:function(){var e=this;this.uploader=new window.AliyunUpload.Vod({userId:0x5bfb091c71f24,region:"cn-shanghai",partSize:1048576,parallel:5,retryCount:3,retryDuration:2,onUploadstarted:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(r){var n,o,a,u,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=null,!r.isImage){t.next=10;break}return t.next=4,i();case 4:o=t.sent,a=o.data,e.imageUrl=a.data.imageURL,n=a.data,t.next=16;break;case 10:return t.next=12,s({fileName:r.file.name});case 12:u=t.sent,c=u.data,e.videoId=c.data.videoId,n=c.data;case 16:e.uploader.setUploadAuthAndAddress(r,n.uploadAuth,n.uploadAddress,n.videoId||n.imageId);case 17:case"end":return t.stop()}}),t)})));function r(e){return t.apply(this,arguments)}return r}(),onUploadSucceed:function(e){console.log("onUploadSucceed",e)},onUploadFailed:function(e,t,r){console.log("onUploadFailed")},onUploadProgress:function(e,t,r){},onUploadTokenExpired:function(e){console.log("onUploadTokenExpired")},onUploadEnd:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(r),console.log({lessonId:e.$route.query.lessonId,fileId:e.videoId,coverImageUrl:e.imageUrl,fileName:e.fileName}),t.next=4,c({lessonId:e.$route.query.lessonId,fileId:e.videoId,coverImageUrl:e.imageUrl,fileName:e.fileName});case 4:n=t.sent,n.data,e.trans=!0,setInterval(Object(a["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l(e.$route.query.lessonId);case 2:r=t.sent,n=r.data,console.log("转码进度",n),100===n.data&&(e.trans=!1,e.$message.success("上传成功"),e.$router.back());case 6:case"end":return t.stop()}}),t)}))),3e3);case 8:case"end":return t.stop()}}),t)})));function r(e){return t.apply(this,arguments)}return r}()})}}},p=f,m=r("2877"),b=Object(m["a"])(p,n,o,!1,null,null,null);t["default"]=b.exports},"37e8":function(e,t,r){var n=r("83ab"),o=r("9bf2"),a=r("825a"),u=r("df75");e.exports=n?Object.defineProperties:function(e,t){a(e);var r,n=u(t),i=n.length,s=0;while(i>s)o.f(e,r=n[s++],t[r]);return e}},"3bbe":function(e,t,r){var n=r("861d");e.exports=function(e){if(!n(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,r){var n=r("1d80"),o=r("5899"),a="["+o+"]",u=RegExp("^"+a+a+"*"),i=RegExp(a+a+"*$"),s=function(e){return function(t){var r=String(n(t));return 1&e&&(r=r.replace(u,"")),2&e&&(r=r.replace(i,"")),r}};e.exports={start:s(1),end:s(2),trim:s(3)}},"6fd8":function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return a})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return i})),r.d(t,"b",(function(){return s}));var n=r("b32d"),o=function(e){return Object(n["a"])({method:"POST",url:"/boss/course/getQueryCourses",data:e})},a=function(e){return Object(n["a"])({method:"GET",url:"/boss/course/changeState",params:e})},u=function(e){return Object(n["a"])({method:"POST",url:"/boss/course/saveOrUpdateCourse",data:e})},i=function(e,t){return Object(n["a"])({method:"POST",url:"/boss/course/upload",data:e,onUploadProgress:t})},s=function(e){return Object(n["a"])({method:"GET",url:"/boss/course/getCourseById",params:{courseId:e}})}},7156:function(e,t,r){var n=r("861d"),o=r("d2bb");e.exports=function(e,t,r){var a,u;return o&&"function"==typeof(a=t.constructor)&&a!==r&&n(u=a.prototype)&&u!==r.prototype&&o(e,u),e}},"7c73":function(e,t,r){var n,o=r("825a"),a=r("37e8"),u=r("7839"),i=r("d012"),s=r("1be4"),c=r("cc12"),l=r("f772"),d=">",f="<",p="prototype",m="script",b=l("IE_PROTO"),h=function(){},v=function(e){return f+m+d+e+f+"/"+m+d},g=function(e){e.write(v("")),e.close();var t=e.parentWindow.Object;return e=null,t},I=function(){var e,t=c("iframe"),r="java"+m+":";return t.style.display="none",s.appendChild(t),t.src=String(r),e=t.contentWindow.document,e.open(),e.write(v("document.F=Object")),e.close(),e.F},y=function(){try{n=document.domain&&new ActiveXObject("htmlfile")}catch(t){}y=n?g(n):I();var e=u.length;while(e--)delete y[p][u[e]];return y()};i[b]=!0,e.exports=Object.create||function(e,t){var r;return null!==e?(h[p]=o(e),r=new h,h[p]=null,r[b]=e):r=y(),void 0===t?r:a(r,t)}},a9e3:function(e,t,r){"use strict";var n=r("83ab"),o=r("da84"),a=r("94ca"),u=r("6eeb"),i=r("5135"),s=r("c6b6"),c=r("7156"),l=r("c04e"),d=r("d039"),f=r("7c73"),p=r("241c").f,m=r("06cf").f,b=r("9bf2").f,h=r("58a8").trim,v="Number",g=o[v],I=g.prototype,y=s(f(I))==v,O=function(e){var t,r,n,o,a,u,i,s,c=l(e,!1);if("string"==typeof c&&c.length>2)if(c=h(c),t=c.charCodeAt(0),43===t||45===t){if(r=c.charCodeAt(2),88===r||120===r)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+c}for(a=c.slice(2),u=a.length,i=0;i<u;i++)if(s=a.charCodeAt(i),s<48||s>o)return NaN;return parseInt(a,n)}return+c};if(a(v,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var w,N=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof N&&(y?d((function(){I.valueOf.call(r)})):s(r)!=v)?c(new g(O(t)),r,N):O(t)},_=n?p(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),x=0;_.length>x;x++)i(g,w=_[x])&&!i(N,w)&&b(N,w,m(g,w));N.prototype=I,I.constructor=N,u(o,v,N)}},b0c0:function(e,t,r){var n=r("83ab"),o=r("9bf2").f,a=Function.prototype,u=a.toString,i=/^\s*function ([^ (]*)/,s="name";n&&!(s in a)&&o(a,s,{configurable:!0,get:function(){try{return u.call(this).match(i)[1]}catch(e){return""}}})},d2bb:function(e,t,r){var n=r("825a"),o=r("3bbe");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,e.call(r,[]),t=r instanceof Array}catch(a){}return function(r,a){return n(r),o(a),t?e.call(r,a):r.__proto__=a,r}}():void 0)},df75:function(e,t,r){var n=r("ca84"),o=r("7839");e.exports=Object.keys||function(e){return n(e,o)}}}]);
//# sourceMappingURL=course-video.c48a8b78.js.map